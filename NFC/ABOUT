<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFC Login with Arduino</title>
    <script>
        let authorizedUIDs = ["04AABBCCDDEE", "1234567890AB"]; // Example NFC UIDs
        let port, reader;
        
        async function connectSerial() {
            try {
                port = await navigator.serial.requestPort();
                await port.open({ baudRate: 115200 });
                reader = port.readable.getReader();
                readNFC();
            } catch (err) {
                console.error("Serial connection failed:", err);
                document.getElementById("status").innerText = "Error: Unable to connect to NFC scanner.";
                document.getElementById("status").style.color = "red";
            }
        }
        
        async function readNFC() {
            let decoder = new TextDecoder();
            try {
                while (true) {
                    const { value, done } = await reader.read();
                    if (done) break;
                    let uid = decoder.decode(value).trim();
                    if (uid) checkLogin(uid);
                }
            } catch (err) {
                console.error("Error reading NFC UID:", err);
            } finally {
                reader.releaseLock();
            }
        }
        
        function checkLogin(uid) {
            let statusElement = document.getElementById("status");
            if (authorizedUIDs.includes(uid)) {
                statusElement.innerText = "Login Successful!";
                statusElement.style.color = "green";
            } else {
                statusElement.innerText = "Access Denied!";
                statusElement.style.color = "red";
            }
        }
    </script>
</head>
<body>
    <h2>NFC Login System</h2>
    <button onclick="connectSerial()">Connect NFC Scanner</button>
    <p id="status">Waiting for NFC scan...</p>
</body>
</html>
